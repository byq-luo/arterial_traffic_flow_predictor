2019-10-15 15:23:09,172 - INFO - Log directory: data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/
2019-10-15 15:23:09,173 - INFO - {'base_dir': 'data/5083_P2_o12_sh/5083_P2_o12_sh7', 'log_level': 'INFO', 'data': {'batch_size': 64, 'dataset_dir': 'data/inputs/5083_P2_o12_h12_sensor_data', 'test_batch_size': 64, 'val_batch_size': 64, 'graph_pkl_filename': 'data/inputs/model/adjacency_matrix_5083_P2.pkl'}, 'model': {'cl_decay_steps': 2000, 'filter_type': 'dual_random_walk', 'single_horizon': True, 'horizon': 7, 'input_dim': 2, 'l1_decay': 0, 'max_diffusion_step': 2, 'num_nodes': 15, 'num_rnn_layers': 2, 'output_dim': 2, 'rnn_units': 64, 'seq_len': 12, 'use_curriculum_learning': True}, 'train': {'base_lr': 0.01, 'dropout': 0, 'epoch': 0, 'epochs': 100, 'epsilon': 0.001, 'global_step': 0, 'lr_decay_ratio': 0.1, 'max_grad_norm': 5, 'max_to_keep': 100, 'min_learning_rate': 2e-06, 'optimizer': 'adam', 'patience': 50, 'steps': [20, 30, 40, 50], 'test_every_n_epochs': 10}}
2019-10-15 15:23:09,538 - INFO - ('x_train', (2730, 12, 15, 2))
2019-10-15 15:23:09,538 - INFO - ('y_train', (2730, 1, 15, 2))
2019-10-15 15:23:09,538 - INFO - ('x_val', (390, 12, 15, 2))
2019-10-15 15:23:09,538 - INFO - ('y_val', (390, 1, 15, 2))
2019-10-15 15:23:09,538 - INFO - ('x_test', (780, 12, 15, 2))
2019-10-15 15:23:09,539 - INFO - ('y_test', (780, 1, 15, 2))
2019-10-15 15:23:34,116 - INFO - Total number of trainable parameters: 373376
Created DCRNN model
2019-10-15 15:23:35,357 - INFO - Start training ...
2019-10-15 15:24:12,447 - INFO - Epoch [0/100] (42) train_mae: 47.8840, val_mae: 38.4762 lr:0.010000 36.6s
2019-10-15 15:24:13,072 - INFO - Val loss decrease from inf to 38.4762, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-38.4762-42
2019-10-15 15:24:51,157 - INFO - Epoch [1/100] (84) train_mae: 32.0998, val_mae: 32.9551 lr:0.010000 38.1s
2019-10-15 15:24:51,186 - INFO - Val loss decrease from 38.4762 to 32.9551, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-32.9551-84
2019-10-15 15:25:30,113 - INFO - Epoch [2/100] (126) train_mae: 28.7801, val_mae: 33.7511 lr:0.010000 38.9s
2019-10-15 15:26:07,986 - INFO - Epoch [3/100] (168) train_mae: 27.8740, val_mae: 24.4404 lr:0.010000 37.9s
2019-10-15 15:26:08,015 - INFO - Val loss decrease from 32.9551 to 24.4404, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-24.4404-168
2019-10-15 15:26:46,950 - INFO - Epoch [4/100] (210) train_mae: 24.2835, val_mae: 22.9813 lr:0.010000 38.9s
2019-10-15 15:26:46,982 - INFO - Val loss decrease from 24.4404 to 22.9813, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-22.9813-210
2019-10-15 15:27:26,650 - INFO - Epoch [5/100] (252) train_mae: 22.9370, val_mae: 25.2022 lr:0.010000 39.7s
2019-10-15 15:28:05,044 - INFO - Epoch [6/100] (294) train_mae: 22.4697, val_mae: 22.4525 lr:0.010000 38.4s
2019-10-15 15:28:05,073 - INFO - Val loss decrease from 22.9813 to 22.4525, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-22.4525-294
2019-10-15 15:28:43,451 - INFO - Epoch [7/100] (336) train_mae: 21.4300, val_mae: 22.4008 lr:0.010000 38.4s
2019-10-15 15:28:43,485 - INFO - Val loss decrease from 22.4525 to 22.4008, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-22.4008-336
2019-10-15 15:29:23,041 - INFO - Epoch [8/100] (378) train_mae: 20.9905, val_mae: 19.3118 lr:0.010000 39.6s
2019-10-15 15:29:23,075 - INFO - Val loss decrease from 22.4008 to 19.3118, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-19.3118-378
2019-10-15 15:30:03,572 - INFO - Epoch [9/100] (420) train_mae: 20.3420, val_mae: 21.3420 lr:0.010000 40.5s
2019-10-15 15:30:09,363 - INFO - Horizon 07, MAE: 39.06, MAPE: 0.1671, RMSE: 59.02
2019-10-15 15:30:49,288 - INFO - Epoch [10/100] (462) train_mae: 21.0484, val_mae: 20.0663 lr:0.010000 39.9s
2019-10-15 15:31:27,964 - INFO - Epoch [11/100] (504) train_mae: 19.9347, val_mae: 18.7728 lr:0.010000 38.7s
2019-10-15 15:31:27,987 - INFO - Val loss decrease from 19.3118 to 18.7728, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-18.7728-504
2019-10-15 15:32:06,247 - INFO - Epoch [12/100] (546) train_mae: 19.2959, val_mae: 19.2758 lr:0.010000 38.3s
2019-10-15 15:32:44,591 - INFO - Epoch [13/100] (588) train_mae: 19.3752, val_mae: 20.6868 lr:0.010000 38.3s
2019-10-15 15:33:23,089 - INFO - Epoch [14/100] (630) train_mae: 19.0526, val_mae: 19.4297 lr:0.010000 38.5s
2019-10-15 15:34:02,109 - INFO - Epoch [15/100] (672) train_mae: 18.9134, val_mae: 19.2258 lr:0.010000 39.0s
2019-10-15 15:34:42,150 - INFO - Epoch [16/100] (714) train_mae: 18.2559, val_mae: 18.8960 lr:0.010000 40.0s
2019-10-15 15:35:22,344 - INFO - Epoch [17/100] (756) train_mae: 18.2602, val_mae: 19.6073 lr:0.010000 40.2s
2019-10-15 15:36:00,803 - INFO - Epoch [18/100] (798) train_mae: 18.0699, val_mae: 18.8264 lr:0.010000 38.5s
2019-10-15 15:36:39,872 - INFO - Epoch [19/100] (840) train_mae: 18.0872, val_mae: 17.2883 lr:0.010000 39.1s
2019-10-15 15:36:45,867 - INFO - Horizon 07, MAE: 34.66, MAPE: 0.1556, RMSE: 53.45
2019-10-15 15:36:45,890 - INFO - Val loss decrease from 18.7728 to 17.2883, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-17.2883-840
2019-10-15 15:37:25,756 - INFO - Epoch [20/100] (882) train_mae: 16.5373, val_mae: 16.8401 lr:0.001000 39.9s
2019-10-15 15:37:25,785 - INFO - Val loss decrease from 17.2883 to 16.8401, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.8401-882
2019-10-15 15:38:06,218 - INFO - Epoch [21/100] (924) train_mae: 16.0874, val_mae: 16.6281 lr:0.001000 40.4s
2019-10-15 15:38:06,241 - INFO - Val loss decrease from 16.8401 to 16.6281, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.6281-924
2019-10-15 15:38:45,758 - INFO - Epoch [22/100] (966) train_mae: 15.9851, val_mae: 16.9217 lr:0.001000 39.5s
2019-10-15 15:39:25,654 - INFO - Epoch [23/100] (1008) train_mae: 15.9151, val_mae: 16.8358 lr:0.001000 39.9s
2019-10-15 15:40:04,357 - INFO - Epoch [24/100] (1050) train_mae: 15.7600, val_mae: 16.6463 lr:0.001000 38.7s
2019-10-15 15:40:44,569 - INFO - Epoch [25/100] (1092) train_mae: 15.5341, val_mae: 16.5474 lr:0.001000 40.2s
2019-10-15 15:40:44,592 - INFO - Val loss decrease from 16.6281 to 16.5474, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.5474-1092
2019-10-15 15:41:26,425 - INFO - Epoch [26/100] (1134) train_mae: 15.8177, val_mae: 16.7669 lr:0.001000 41.8s
2019-10-15 15:42:06,732 - INFO - Epoch [27/100] (1176) train_mae: 15.4492, val_mae: 16.6631 lr:0.001000 40.3s
2019-10-15 15:42:45,279 - INFO - Epoch [28/100] (1218) train_mae: 15.2471, val_mae: 16.7331 lr:0.001000 38.5s
2019-10-15 15:43:25,418 - INFO - Epoch [29/100] (1260) train_mae: 15.2460, val_mae: 16.6515 lr:0.001000 40.1s
2019-10-15 15:43:30,824 - INFO - Horizon 07, MAE: 34.16, MAPE: 0.1459, RMSE: 53.73
2019-10-15 15:44:11,174 - INFO - Epoch [30/100] (1302) train_mae: 14.8994, val_mae: 16.5506 lr:0.000100 40.3s
2019-10-15 15:44:52,302 - INFO - Epoch [31/100] (1344) train_mae: 15.1914, val_mae: 16.4607 lr:0.000100 41.1s
2019-10-15 15:44:52,326 - INFO - Val loss decrease from 16.5474 to 16.4607, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.4607-1344
2019-10-15 15:45:32,966 - INFO - Epoch [32/100] (1386) train_mae: 14.7119, val_mae: 16.3412 lr:0.000100 40.6s
2019-10-15 15:45:32,991 - INFO - Val loss decrease from 16.4607 to 16.3412, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.3412-1386
2019-10-15 15:46:13,410 - INFO - Epoch [33/100] (1428) train_mae: 14.9737, val_mae: 16.4207 lr:0.000100 40.4s
2019-10-15 15:46:55,434 - INFO - Epoch [34/100] (1470) train_mae: 14.7631, val_mae: 16.3454 lr:0.000100 42.0s
2019-10-15 15:47:38,114 - INFO - Epoch [35/100] (1512) train_mae: 14.9699, val_mae: 16.4307 lr:0.000100 42.7s
2019-10-15 15:48:19,338 - INFO - Epoch [36/100] (1554) train_mae: 15.0674, val_mae: 16.5231 lr:0.000100 41.2s
2019-10-15 15:49:04,099 - INFO - Epoch [37/100] (1596) train_mae: 14.6234, val_mae: 16.5341 lr:0.000100 44.8s
2019-10-15 15:49:46,922 - INFO - Epoch [38/100] (1638) train_mae: 14.7538, val_mae: 16.3756 lr:0.000100 42.8s
2019-10-15 15:50:27,685 - INFO - Epoch [39/100] (1680) train_mae: 14.8214, val_mae: 16.2919 lr:0.000100 40.8s
2019-10-15 15:50:32,661 - INFO - Horizon 07, MAE: 33.69, MAPE: 0.1480, RMSE: 52.93
2019-10-15 15:50:32,683 - INFO - Val loss decrease from 16.3412 to 16.2919, saving to data/5083_P2_o12_sh/5083_P2_o12_sh7/dcrnn_DR_2_sh_7_64-64_lr_0.01_bs_64_20191015152309/models-16.2919-1680
2019-10-15 15:51:14,091 - INFO - Epoch [40/100] (1722) train_mae: 14.7285, val_mae: 16.3913 lr:0.000010 41.4s
2019-10-15 15:51:56,606 - INFO - Epoch [41/100] (1764) train_mae: 14.7047, val_mae: 16.4319 lr:0.000010 42.5s
2019-10-15 15:52:37,410 - INFO - Epoch [42/100] (1806) train_mae: 14.8440, val_mae: 16.4293 lr:0.000010 40.8s
2019-10-15 15:53:18,618 - INFO - Epoch [43/100] (1848) train_mae: 14.7094, val_mae: 16.4942 lr:0.000010 41.2s
2019-10-15 15:53:59,648 - INFO - Epoch [44/100] (1890) train_mae: 14.7627, val_mae: 16.4643 lr:0.000010 41.0s
2019-10-15 15:54:39,610 - INFO - Epoch [45/100] (1932) train_mae: 14.7530, val_mae: 16.5003 lr:0.000010 40.0s
2019-10-15 15:55:21,215 - INFO - Epoch [46/100] (1974) train_mae: 14.7974, val_mae: 16.5066 lr:0.000010 41.6s
2019-10-15 15:56:02,768 - INFO - Epoch [47/100] (2016) train_mae: 14.5116, val_mae: 16.4443 lr:0.000010 41.6s
2019-10-15 15:56:45,194 - INFO - Epoch [48/100] (2058) train_mae: 14.6340, val_mae: 16.4448 lr:0.000010 42.4s
2019-10-15 15:57:29,000 - INFO - Epoch [49/100] (2100) train_mae: 14.7737, val_mae: 16.4558 lr:0.000010 43.8s
2019-10-15 15:57:32,888 - INFO - Horizon 07, MAE: 33.87, MAPE: 0.1464, RMSE: 53.29
2019-10-15 15:58:15,272 - INFO - Epoch [50/100] (2142) train_mae: 14.7048, val_mae: 16.4520 lr:0.000002 42.4s
2019-10-15 15:58:59,654 - INFO - Epoch [51/100] (2184) train_mae: 14.6279, val_mae: 16.4654 lr:0.000002 44.4s
2019-10-15 15:59:43,947 - INFO - Epoch [52/100] (2226) train_mae: 14.6704, val_mae: 16.4667 lr:0.000002 44.3s
2019-10-15 16:00:30,476 - INFO - Epoch [53/100] (2268) train_mae: 14.7474, val_mae: 16.4657 lr:0.000002 46.5s
2019-10-15 16:01:15,642 - INFO - Epoch [54/100] (2310) train_mae: 14.7612, val_mae: 16.4659 lr:0.000002 45.2s
2019-10-15 16:01:50,248 - INFO - Epoch [55/100] (2352) train_mae: 14.8546, val_mae: 16.4558 lr:0.000002 34.6s
2019-10-15 16:02:24,742 - INFO - Epoch [56/100] (2394) train_mae: 14.5483, val_mae: 16.4568 lr:0.000002 34.5s
2019-10-15 16:02:59,244 - INFO - Epoch [57/100] (2436) train_mae: 14.7666, val_mae: 16.4420 lr:0.000002 34.5s
2019-10-15 16:03:32,836 - INFO - Epoch [58/100] (2478) train_mae: 14.5907, val_mae: 16.4417 lr:0.000002 33.6s
2019-10-15 16:04:08,625 - INFO - Epoch [59/100] (2520) train_mae: 14.6418, val_mae: 16.4545 lr:0.000002 35.8s
2019-10-15 16:04:16,393 - INFO - Horizon 07, MAE: 33.86, MAPE: 0.1459, RMSE: 53.27
2019-10-15 16:04:50,650 - INFO - Epoch [60/100] (2562) train_mae: 14.7716, val_mae: 16.4450 lr:0.000002 34.3s
2019-10-15 16:05:23,745 - INFO - Epoch [61/100] (2604) train_mae: 14.5674, val_mae: 16.4359 lr:0.000002 33.1s
2019-10-15 16:05:58,330 - INFO - Epoch [62/100] (2646) train_mae: 14.7729, val_mae: 16.4331 lr:0.000002 34.6s
2019-10-15 16:06:31,688 - INFO - Epoch [63/100] (2688) train_mae: 14.7275, val_mae: 16.4329 lr:0.000002 33.4s
2019-10-15 16:07:05,370 - INFO - Epoch [64/100] (2730) train_mae: 14.9450, val_mae: 16.4396 lr:0.000002 33.7s
2019-10-15 16:07:39,247 - INFO - Epoch [65/100] (2772) train_mae: 14.6410, val_mae: 16.4412 lr:0.000002 33.9s
2019-10-15 16:08:12,962 - INFO - Epoch [66/100] (2814) train_mae: 14.7753, val_mae: 16.4335 lr:0.000002 33.7s
2019-10-15 16:08:46,329 - INFO - Epoch [67/100] (2856) train_mae: 14.8851, val_mae: 16.4362 lr:0.000002 33.4s
2019-10-15 16:09:20,614 - INFO - Epoch [68/100] (2898) train_mae: 14.6175, val_mae: 16.4475 lr:0.000002 34.3s
2019-10-15 16:09:54,918 - INFO - Epoch [69/100] (2940) train_mae: 14.5522, val_mae: 16.4601 lr:0.000002 34.3s
2019-10-15 16:10:00,404 - INFO - Horizon 07, MAE: 33.86, MAPE: 0.1461, RMSE: 53.26
2019-10-15 16:10:34,030 - INFO - Epoch [70/100] (2982) train_mae: 14.7110, val_mae: 16.4694 lr:0.000002 33.6s
2019-10-15 16:11:05,814 - INFO - Epoch [71/100] (3024) train_mae: 14.5224, val_mae: 16.4648 lr:0.000002 31.8s
2019-10-15 16:11:39,939 - INFO - Epoch [72/100] (3066) train_mae: 14.7412, val_mae: 16.4777 lr:0.000002 34.1s
2019-10-15 16:12:13,444 - INFO - Epoch [73/100] (3108) train_mae: 14.7271, val_mae: 16.4838 lr:0.000002 33.5s
2019-10-15 16:12:46,405 - INFO - Epoch [74/100] (3150) train_mae: 14.6758, val_mae: 16.4800 lr:0.000002 33.0s
2019-10-15 16:13:18,965 - INFO - Epoch [75/100] (3192) train_mae: 14.5854, val_mae: 16.4631 lr:0.000002 32.6s
2019-10-15 16:13:53,420 - INFO - Epoch [76/100] (3234) train_mae: 14.7087, val_mae: 16.4646 lr:0.000002 34.5s
2019-10-15 16:14:26,280 - INFO - Epoch [77/100] (3276) train_mae: 14.6353, val_mae: 16.4591 lr:0.000002 32.9s
2019-10-15 16:14:59,968 - INFO - Epoch [78/100] (3318) train_mae: 14.6339, val_mae: 16.4580 lr:0.000002 33.7s
2019-10-15 16:15:32,803 - INFO - Epoch [79/100] (3360) train_mae: 14.7276, val_mae: 16.4572 lr:0.000002 32.8s
2019-10-15 16:15:37,866 - INFO - Horizon 07, MAE: 33.84, MAPE: 0.1459, RMSE: 53.26
2019-10-15 16:16:06,090 - INFO - Epoch [80/100] (3402) train_mae: 14.5174, val_mae: 16.4532 lr:0.000002 28.2s
2019-10-15 16:16:30,556 - INFO - Epoch [81/100] (3444) train_mae: 14.6976, val_mae: 16.4509 lr:0.000002 24.5s
2019-10-15 16:16:55,010 - INFO - Epoch [82/100] (3486) train_mae: 14.9739, val_mae: 16.4459 lr:0.000002 24.5s
2019-10-15 16:17:19,733 - INFO - Epoch [83/100] (3528) train_mae: 14.6699, val_mae: 16.4599 lr:0.000002 24.7s
2019-10-15 16:17:46,178 - INFO - Epoch [84/100] (3570) train_mae: 14.6264, val_mae: 16.4641 lr:0.000002 26.4s
2019-10-15 16:18:11,939 - INFO - Epoch [85/100] (3612) train_mae: 14.6086, val_mae: 16.4609 lr:0.000002 25.8s
2019-10-15 16:18:29,561 - INFO - Epoch [86/100] (3654) train_mae: 14.6980, val_mae: 16.4583 lr:0.000002 17.6s
2019-10-15 16:18:46,445 - INFO - Epoch [87/100] (3696) train_mae: 14.9082, val_mae: 16.4469 lr:0.000002 16.9s
2019-10-15 16:19:02,903 - INFO - Epoch [88/100] (3738) train_mae: 14.8805, val_mae: 16.4544 lr:0.000002 16.5s
2019-10-15 16:19:19,607 - INFO - Epoch [89/100] (3780) train_mae: 14.8767, val_mae: 16.4615 lr:0.000002 16.7s
2019-10-15 16:19:22,185 - INFO - Horizon 07, MAE: 33.87, MAPE: 0.1463, RMSE: 53.25
2019-10-15 16:19:38,398 - INFO - Epoch [90/100] (3822) train_mae: 14.7708, val_mae: 16.4650 lr:0.000002 16.2s
2019-10-15 16:19:38,399 - WARNING - Early stopping at epoch: 90
2019-10-15 16:19:40,967 - INFO - Horizon 07, MAE: 33.88, MAPE: 0.1463, RMSE: 53.27
Predictions saved as data/5083_P2_o12_sh/5083_P2_o12_sh7/predictions.npz.
Trained DCRNN model
train mae: 14.7708
val mae: 16.465
test mse: 3326.2060782914687
test rmse: 57.67327005027085
test mae: 34.578739743094154
test mape: 76.25273063385185
