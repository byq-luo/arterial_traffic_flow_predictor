2019-10-15 15:22:37,962 - INFO - Log directory: data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/
2019-10-15 15:22:37,963 - INFO - {'base_dir': 'data/5083_P2_o12_sh/5083_P2_o12_sh6', 'log_level': 'INFO', 'data': {'batch_size': 64, 'dataset_dir': 'data/inputs/5083_P2_o12_h12_sensor_data', 'test_batch_size': 64, 'val_batch_size': 64, 'graph_pkl_filename': 'data/inputs/model/adjacency_matrix_5083_P2.pkl'}, 'model': {'cl_decay_steps': 2000, 'filter_type': 'dual_random_walk', 'single_horizon': True, 'horizon': 6, 'input_dim': 2, 'l1_decay': 0, 'max_diffusion_step': 2, 'num_nodes': 15, 'num_rnn_layers': 2, 'output_dim': 2, 'rnn_units': 64, 'seq_len': 12, 'use_curriculum_learning': True}, 'train': {'base_lr': 0.01, 'dropout': 0, 'epoch': 0, 'epochs': 100, 'epsilon': 0.001, 'global_step': 0, 'lr_decay_ratio': 0.1, 'max_grad_norm': 5, 'max_to_keep': 100, 'min_learning_rate': 2e-06, 'optimizer': 'adam', 'patience': 50, 'steps': [20, 30, 40, 50], 'test_every_n_epochs': 10}}
2019-10-15 15:22:38,064 - INFO - ('x_train', (2730, 12, 15, 2))
2019-10-15 15:22:38,064 - INFO - ('y_train', (2730, 1, 15, 2))
2019-10-15 15:22:38,065 - INFO - ('x_val', (390, 12, 15, 2))
2019-10-15 15:22:38,065 - INFO - ('y_val', (390, 1, 15, 2))
2019-10-15 15:22:38,065 - INFO - ('x_test', (780, 12, 15, 2))
2019-10-15 15:22:38,065 - INFO - ('y_test', (780, 1, 15, 2))
2019-10-15 15:22:49,414 - INFO - Total number of trainable parameters: 373376
Created DCRNN model
2019-10-15 15:22:50,351 - INFO - Start training ...
2019-10-15 15:23:16,992 - INFO - Epoch [0/100] (42) train_mae: 40.8300, val_mae: 34.5205 lr:0.010000 26.3s
2019-10-15 15:23:17,463 - INFO - Val loss decrease from inf to 34.5205, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-34.5205-42
2019-10-15 15:23:43,072 - INFO - Epoch [1/100] (84) train_mae: 30.1623, val_mae: 30.9941 lr:0.010000 25.6s
2019-10-15 15:23:43,094 - INFO - Val loss decrease from 34.5205 to 30.9941, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-30.9941-84
2019-10-15 15:24:19,128 - INFO - Epoch [2/100] (126) train_mae: 27.3080, val_mae: 30.1394 lr:0.010000 36.0s
2019-10-15 15:24:19,150 - INFO - Val loss decrease from 30.9941 to 30.1394, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-30.1394-126
2019-10-15 15:24:56,659 - INFO - Epoch [3/100] (168) train_mae: 25.8908, val_mae: 29.5482 lr:0.010000 37.5s
2019-10-15 15:24:56,681 - INFO - Val loss decrease from 30.1394 to 29.5482, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-29.5482-168
2019-10-15 15:25:35,045 - INFO - Epoch [4/100] (210) train_mae: 24.0278, val_mae: 22.9797 lr:0.010000 38.4s
2019-10-15 15:25:35,068 - INFO - Val loss decrease from 29.5482 to 22.9797, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-22.9797-210
2019-10-15 15:26:12,907 - INFO - Epoch [5/100] (252) train_mae: 21.9254, val_mae: 21.5394 lr:0.010000 37.8s
2019-10-15 15:26:12,926 - INFO - Val loss decrease from 22.9797 to 21.5394, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-21.5394-252
2019-10-15 15:26:51,485 - INFO - Epoch [6/100] (294) train_mae: 21.4103, val_mae: 23.2339 lr:0.010000 38.6s
2019-10-15 15:27:30,958 - INFO - Epoch [7/100] (336) train_mae: 21.6804, val_mae: 20.7820 lr:0.010000 39.5s
2019-10-15 15:27:30,976 - INFO - Val loss decrease from 21.5394 to 20.7820, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-20.7820-336
2019-10-15 15:28:09,430 - INFO - Epoch [8/100] (378) train_mae: 20.9606, val_mae: 20.4834 lr:0.010000 38.5s
2019-10-15 15:28:09,450 - INFO - Val loss decrease from 20.7820 to 20.4834, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-20.4834-378
2019-10-15 15:28:48,718 - INFO - Epoch [9/100] (420) train_mae: 20.3948, val_mae: 19.8845 lr:0.010000 39.3s
2019-10-15 15:28:52,979 - INFO - Horizon 06, MAE: 36.51, MAPE: 0.1769, RMSE: 55.20
2019-10-15 15:28:53,014 - INFO - Val loss decrease from 20.4834 to 19.8845, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-19.8845-420
2019-10-15 15:29:31,798 - INFO - Epoch [10/100] (462) train_mae: 20.0354, val_mae: 22.0567 lr:0.010000 38.8s
2019-10-15 15:30:11,168 - INFO - Epoch [11/100] (504) train_mae: 20.0808, val_mae: 20.0215 lr:0.010000 39.4s
2019-10-15 15:30:50,854 - INFO - Epoch [12/100] (546) train_mae: 18.9309, val_mae: 19.9829 lr:0.010000 39.7s
2019-10-15 15:31:29,962 - INFO - Epoch [13/100] (588) train_mae: 18.4714, val_mae: 20.7519 lr:0.010000 39.1s
2019-10-15 15:32:08,489 - INFO - Epoch [14/100] (630) train_mae: 18.4546, val_mae: 20.9453 lr:0.010000 38.5s
2019-10-15 15:32:47,021 - INFO - Epoch [15/100] (672) train_mae: 17.8832, val_mae: 20.1341 lr:0.010000 38.5s
2019-10-15 15:33:25,870 - INFO - Epoch [16/100] (714) train_mae: 18.2203, val_mae: 19.9029 lr:0.010000 38.8s
2019-10-15 15:34:04,938 - INFO - Epoch [17/100] (756) train_mae: 17.9783, val_mae: 20.3146 lr:0.010000 39.1s
2019-10-15 15:34:43,838 - INFO - Epoch [18/100] (798) train_mae: 17.9137, val_mae: 20.6136 lr:0.010000 38.9s
2019-10-15 15:35:24,010 - INFO - Epoch [19/100] (840) train_mae: 17.7787, val_mae: 18.5157 lr:0.010000 40.2s
2019-10-15 15:35:28,761 - INFO - Horizon 06, MAE: 34.27, MAPE: 0.1537, RMSE: 53.30
2019-10-15 15:35:28,784 - INFO - Val loss decrease from 19.8845 to 18.5157, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-18.5157-840
2019-10-15 15:36:08,730 - INFO - Epoch [20/100] (882) train_mae: 16.3910, val_mae: 17.7411 lr:0.001000 39.9s
2019-10-15 15:36:08,753 - INFO - Val loss decrease from 18.5157 to 17.7411, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-17.7411-882
2019-10-15 15:36:48,373 - INFO - Epoch [21/100] (924) train_mae: 15.8364, val_mae: 17.3291 lr:0.001000 39.6s
2019-10-15 15:36:48,403 - INFO - Val loss decrease from 17.7411 to 17.3291, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-17.3291-924
2019-10-15 15:37:27,915 - INFO - Epoch [22/100] (966) train_mae: 15.8420, val_mae: 17.2095 lr:0.001000 39.5s
2019-10-15 15:37:27,937 - INFO - Val loss decrease from 17.3291 to 17.2095, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-17.2095-966
2019-10-15 15:38:08,256 - INFO - Epoch [23/100] (1008) train_mae: 15.4249, val_mae: 16.8717 lr:0.001000 40.3s
2019-10-15 15:38:08,282 - INFO - Val loss decrease from 17.2095 to 16.8717, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-16.8717-1008
2019-10-15 15:38:47,925 - INFO - Epoch [24/100] (1050) train_mae: 15.2520, val_mae: 17.0793 lr:0.001000 39.6s
2019-10-15 15:39:27,764 - INFO - Epoch [25/100] (1092) train_mae: 15.7056, val_mae: 17.1179 lr:0.001000 39.8s
2019-10-15 15:40:06,958 - INFO - Epoch [26/100] (1134) train_mae: 15.2938, val_mae: 17.3419 lr:0.001000 39.2s
2019-10-15 15:40:47,065 - INFO - Epoch [27/100] (1176) train_mae: 15.0166, val_mae: 17.3156 lr:0.001000 40.1s
2019-10-15 15:41:28,783 - INFO - Epoch [28/100] (1218) train_mae: 15.3478, val_mae: 16.8047 lr:0.001000 41.7s
2019-10-15 15:41:28,806 - INFO - Val loss decrease from 16.8717 to 16.8047, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-16.8047-1218
2019-10-15 15:42:10,064 - INFO - Epoch [29/100] (1260) train_mae: 15.0758, val_mae: 17.1983 lr:0.001000 41.3s
2019-10-15 15:42:16,797 - INFO - Horizon 06, MAE: 32.69, MAPE: 0.1458, RMSE: 50.59
2019-10-15 15:43:00,985 - INFO - Epoch [30/100] (1302) train_mae: 14.8654, val_mae: 16.6000 lr:0.000100 44.2s
2019-10-15 15:43:01,021 - INFO - Val loss decrease from 16.8047 to 16.6000, saving to data/5083_P2_o12_sh/5083_P2_o12_sh6/dcrnn_DR_2_sh_6_64-64_lr_0.01_bs_64_20191015152237/models-16.6000-1302
2019-10-15 15:43:45,689 - INFO - Epoch [31/100] (1344) train_mae: 14.7019, val_mae: 16.8549 lr:0.000100 44.7s
2019-10-15 15:44:31,967 - INFO - Epoch [32/100] (1386) train_mae: 14.6402, val_mae: 16.8631 lr:0.000100 46.3s
2019-10-15 15:45:16,514 - INFO - Epoch [33/100] (1428) train_mae: 14.6893, val_mae: 16.8392 lr:0.000100 44.5s
2019-10-15 15:46:02,637 - INFO - Epoch [34/100] (1470) train_mae: 14.8644, val_mae: 16.8929 lr:0.000100 46.1s
2019-10-15 15:46:47,793 - INFO - Epoch [35/100] (1512) train_mae: 14.6710, val_mae: 16.7125 lr:0.000100 45.2s
2019-10-15 15:47:32,499 - INFO - Epoch [36/100] (1554) train_mae: 14.5867, val_mae: 17.0010 lr:0.000100 44.7s
2019-10-15 15:48:14,749 - INFO - Epoch [37/100] (1596) train_mae: 14.6345, val_mae: 16.9778 lr:0.000100 42.2s
2019-10-15 15:49:00,172 - INFO - Epoch [38/100] (1638) train_mae: 14.5504, val_mae: 16.8633 lr:0.000100 45.4s
2019-10-15 15:49:43,250 - INFO - Epoch [39/100] (1680) train_mae: 14.6244, val_mae: 16.7160 lr:0.000100 43.1s
2019-10-15 15:49:47,913 - INFO - Horizon 06, MAE: 32.45, MAPE: 0.1469, RMSE: 50.41
2019-10-15 15:50:29,437 - INFO - Epoch [40/100] (1722) train_mae: 14.4531, val_mae: 16.6882 lr:0.000010 41.5s
2019-10-15 15:51:10,849 - INFO - Epoch [41/100] (1764) train_mae: 14.4813, val_mae: 16.7189 lr:0.000010 41.4s
2019-10-15 15:51:52,632 - INFO - Epoch [42/100] (1806) train_mae: 14.4901, val_mae: 16.7590 lr:0.000010 41.8s
2019-10-15 15:52:34,436 - INFO - Epoch [43/100] (1848) train_mae: 14.5531, val_mae: 16.6924 lr:0.000010 41.8s
2019-10-15 15:53:16,083 - INFO - Epoch [44/100] (1890) train_mae: 14.7314, val_mae: 16.7697 lr:0.000010 41.6s
2019-10-15 15:53:57,565 - INFO - Epoch [45/100] (1932) train_mae: 14.4529, val_mae: 16.7253 lr:0.000010 41.5s
2019-10-15 15:54:37,044 - INFO - Epoch [46/100] (1974) train_mae: 14.5606, val_mae: 16.7121 lr:0.000010 39.5s
2019-10-15 15:55:19,675 - INFO - Epoch [47/100] (2016) train_mae: 14.4685, val_mae: 16.6757 lr:0.000010 42.6s
2019-10-15 15:56:00,651 - INFO - Epoch [48/100] (2058) train_mae: 14.6738, val_mae: 16.7446 lr:0.000010 41.0s
2019-10-15 15:56:42,207 - INFO - Epoch [49/100] (2100) train_mae: 14.3555, val_mae: 16.7489 lr:0.000010 41.6s
2019-10-15 15:56:46,219 - INFO - Horizon 06, MAE: 32.43, MAPE: 0.1484, RMSE: 50.33
2019-10-15 15:57:30,212 - INFO - Epoch [50/100] (2142) train_mae: 14.5020, val_mae: 16.7467 lr:0.000002 44.0s
2019-10-15 15:58:11,569 - INFO - Epoch [51/100] (2184) train_mae: 14.4762, val_mae: 16.7373 lr:0.000002 41.4s
2019-10-15 15:58:52,867 - INFO - Epoch [52/100] (2226) train_mae: 14.6321, val_mae: 16.7525 lr:0.000002 41.3s
2019-10-15 15:59:35,305 - INFO - Epoch [53/100] (2268) train_mae: 14.5053, val_mae: 16.7578 lr:0.000002 42.4s
2019-10-15 16:00:16,297 - INFO - Epoch [54/100] (2310) train_mae: 14.5371, val_mae: 16.7531 lr:0.000002 41.0s
2019-10-15 16:00:57,676 - INFO - Epoch [55/100] (2352) train_mae: 14.6402, val_mae: 16.7651 lr:0.000002 41.4s
2019-10-15 16:01:34,005 - INFO - Epoch [56/100] (2394) train_mae: 14.6490, val_mae: 16.7757 lr:0.000002 36.3s
2019-10-15 16:02:05,214 - INFO - Epoch [57/100] (2436) train_mae: 14.7776, val_mae: 16.7863 lr:0.000002 31.2s
2019-10-15 16:02:37,985 - INFO - Epoch [58/100] (2478) train_mae: 14.8060, val_mae: 16.7854 lr:0.000002 32.8s
2019-10-15 16:03:09,811 - INFO - Epoch [59/100] (2520) train_mae: 14.7558, val_mae: 16.7834 lr:0.000002 31.8s
2019-10-15 16:03:15,171 - INFO - Horizon 06, MAE: 32.43, MAPE: 0.1476, RMSE: 50.39
2019-10-15 16:03:48,974 - INFO - Epoch [60/100] (2562) train_mae: 14.5948, val_mae: 16.7784 lr:0.000002 33.8s
2019-10-15 16:04:22,933 - INFO - Epoch [61/100] (2604) train_mae: 14.5895, val_mae: 16.7606 lr:0.000002 34.0s
2019-10-15 16:04:56,403 - INFO - Epoch [62/100] (2646) train_mae: 14.4992, val_mae: 16.7620 lr:0.000002 33.5s
2019-10-15 16:05:29,973 - INFO - Epoch [63/100] (2688) train_mae: 14.5013, val_mae: 16.7639 lr:0.000002 33.6s
2019-10-15 16:06:03,343 - INFO - Epoch [64/100] (2730) train_mae: 14.4323, val_mae: 16.7663 lr:0.000002 33.4s
2019-10-15 16:06:36,123 - INFO - Epoch [65/100] (2772) train_mae: 14.5057, val_mae: 16.7675 lr:0.000002 32.8s
2019-10-15 16:07:09,767 - INFO - Epoch [66/100] (2814) train_mae: 14.6701, val_mae: 16.7641 lr:0.000002 33.6s
2019-10-15 16:07:42,990 - INFO - Epoch [67/100] (2856) train_mae: 14.5137, val_mae: 16.7673 lr:0.000002 33.2s
2019-10-15 16:08:16,506 - INFO - Epoch [68/100] (2898) train_mae: 14.5833, val_mae: 16.7826 lr:0.000002 33.5s
2019-10-15 16:08:49,088 - INFO - Epoch [69/100] (2940) train_mae: 14.6272, val_mae: 16.7838 lr:0.000002 32.6s
2019-10-15 16:08:53,023 - INFO - Horizon 06, MAE: 32.42, MAPE: 0.1475, RMSE: 50.40
2019-10-15 16:09:26,812 - INFO - Epoch [70/100] (2982) train_mae: 14.5649, val_mae: 16.7855 lr:0.000002 33.8s
2019-10-15 16:10:00,853 - INFO - Epoch [71/100] (3024) train_mae: 14.7447, val_mae: 16.7734 lr:0.000002 34.0s
2019-10-15 16:10:34,045 - INFO - Epoch [72/100] (3066) train_mae: 14.7752, val_mae: 16.7648 lr:0.000002 33.2s
2019-10-15 16:11:05,895 - INFO - Epoch [73/100] (3108) train_mae: 14.3754, val_mae: 16.7572 lr:0.000002 31.8s
2019-10-15 16:11:39,691 - INFO - Epoch [74/100] (3150) train_mae: 14.5041, val_mae: 16.7495 lr:0.000002 33.8s
2019-10-15 16:12:13,530 - INFO - Epoch [75/100] (3192) train_mae: 14.5642, val_mae: 16.7631 lr:0.000002 33.8s
2019-10-15 16:12:46,424 - INFO - Epoch [76/100] (3234) train_mae: 14.5096, val_mae: 16.7539 lr:0.000002 32.9s
2019-10-15 16:13:18,715 - INFO - Epoch [77/100] (3276) train_mae: 14.5122, val_mae: 16.7311 lr:0.000002 32.3s
2019-10-15 16:13:52,752 - INFO - Epoch [78/100] (3318) train_mae: 14.5659, val_mae: 16.7360 lr:0.000002 34.0s
2019-10-15 16:14:25,765 - INFO - Epoch [79/100] (3360) train_mae: 14.5958, val_mae: 16.7558 lr:0.000002 33.0s
2019-10-15 16:14:30,841 - INFO - Horizon 06, MAE: 32.41, MAPE: 0.1474, RMSE: 50.37
2019-10-15 16:15:04,526 - INFO - Epoch [80/100] (3402) train_mae: 14.3933, val_mae: 16.7479 lr:0.000002 33.7s
2019-10-15 16:15:38,388 - INFO - Epoch [81/100] (3444) train_mae: 14.5432, val_mae: 16.7610 lr:0.000002 33.9s
2019-10-15 16:15:38,390 - WARNING - Early stopping at epoch: 81
2019-10-15 16:15:43,363 - INFO - Horizon 06, MAE: 32.41, MAPE: 0.1476, RMSE: 50.37
Predictions saved as data/5083_P2_o12_sh/5083_P2_o12_sh6/predictions.npz.
Trained DCRNN model
train mae: 14.5432
val mae: 16.761
test mse: 2923.338966840794
test rmse: 54.06791069424445
test mae: 33.03783657497829
test mape: 67.50592884910205
