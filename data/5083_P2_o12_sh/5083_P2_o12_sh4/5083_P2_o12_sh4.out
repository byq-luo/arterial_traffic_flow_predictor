2019-10-15 14:35:56,221 - INFO - Log directory: data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/
2019-10-15 14:35:56,222 - INFO - {'base_dir': 'data/5083_P2_o12_sh/5083_P2_o12_sh4', 'log_level': 'INFO', 'data': {'batch_size': 64, 'dataset_dir': 'data/inputs/5083_P2_o12_h12_sensor_data', 'test_batch_size': 64, 'val_batch_size': 64, 'graph_pkl_filename': 'data/inputs/model/adjacency_matrix_5083_P2.pkl'}, 'model': {'cl_decay_steps': 2000, 'filter_type': 'dual_random_walk', 'single_horizon': True, 'horizon': 4, 'input_dim': 2, 'l1_decay': 0, 'max_diffusion_step': 2, 'num_nodes': 15, 'num_rnn_layers': 2, 'output_dim': 2, 'rnn_units': 64, 'seq_len': 12, 'use_curriculum_learning': True}, 'train': {'base_lr': 0.01, 'dropout': 0, 'epoch': 0, 'epochs': 100, 'epsilon': 0.001, 'global_step': 0, 'lr_decay_ratio': 0.1, 'max_grad_norm': 5, 'max_to_keep': 100, 'min_learning_rate': 2e-06, 'optimizer': 'adam', 'patience': 50, 'steps': [20, 30, 40, 50], 'test_every_n_epochs': 10}}
2019-10-15 14:35:56,314 - INFO - ('x_train', (2730, 12, 15, 2))
2019-10-15 14:35:56,314 - INFO - ('y_train', (2730, 1, 15, 2))
2019-10-15 14:35:56,315 - INFO - ('x_val', (390, 12, 15, 2))
2019-10-15 14:35:56,315 - INFO - ('y_val', (390, 1, 15, 2))
2019-10-15 14:35:56,315 - INFO - ('x_test', (780, 12, 15, 2))
2019-10-15 14:35:56,315 - INFO - ('y_test', (780, 1, 15, 2))
2019-10-15 14:36:02,923 - INFO - Total number of trainable parameters: 373376
Created DCRNN model
2019-10-15 14:36:03,411 - INFO - Start training ...
2019-10-15 14:36:18,472 - INFO - Epoch [0/100] (42) train_mae: 36.5152, val_mae: 28.8499 lr:0.010000 14.9s
2019-10-15 14:36:18,689 - INFO - Val loss decrease from inf to 28.8499, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-28.8499-42
2019-10-15 14:36:34,294 - INFO - Epoch [1/100] (84) train_mae: 22.1136, val_mae: 23.2601 lr:0.010000 15.6s
2019-10-15 14:36:34,308 - INFO - Val loss decrease from 28.8499 to 23.2601, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-23.2601-84
2019-10-15 14:36:49,363 - INFO - Epoch [2/100] (126) train_mae: 21.3913, val_mae: 23.8169 lr:0.010000 15.1s
2019-10-15 14:37:04,514 - INFO - Epoch [3/100] (168) train_mae: 20.8834, val_mae: 24.7144 lr:0.010000 15.2s
2019-10-15 14:37:19,689 - INFO - Epoch [4/100] (210) train_mae: 20.5490, val_mae: 21.6276 lr:0.010000 15.2s
2019-10-15 14:37:19,703 - INFO - Val loss decrease from 23.2601 to 21.6276, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-21.6276-210
2019-10-15 14:37:34,949 - INFO - Epoch [5/100] (252) train_mae: 20.2586, val_mae: 22.1530 lr:0.010000 15.2s
2019-10-15 14:37:50,385 - INFO - Epoch [6/100] (294) train_mae: 19.4186, val_mae: 20.6704 lr:0.010000 15.4s
2019-10-15 14:37:50,399 - INFO - Val loss decrease from 21.6276 to 20.6704, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-20.6704-294
2019-10-15 14:38:05,902 - INFO - Epoch [7/100] (336) train_mae: 17.6939, val_mae: 18.8104 lr:0.010000 15.5s
2019-10-15 14:38:05,916 - INFO - Val loss decrease from 20.6704 to 18.8104, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-18.8104-336
2019-10-15 14:38:21,496 - INFO - Epoch [8/100] (378) train_mae: 17.3922, val_mae: 21.0763 lr:0.010000 15.6s
2019-10-15 14:38:36,944 - INFO - Epoch [9/100] (420) train_mae: 17.3223, val_mae: 17.3515 lr:0.010000 15.4s
2019-10-15 14:38:39,018 - INFO - Horizon 04, MAE: 30.84, MAPE: 0.1700, RMSE: 44.21
2019-10-15 14:38:39,032 - INFO - Val loss decrease from 18.8104 to 17.3515, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-17.3515-420
2019-10-15 14:38:54,884 - INFO - Epoch [10/100] (462) train_mae: 17.4605, val_mae: 18.3093 lr:0.010000 15.9s
2019-10-15 14:39:10,444 - INFO - Epoch [11/100] (504) train_mae: 16.4871, val_mae: 17.9507 lr:0.010000 15.6s
2019-10-15 14:39:25,860 - INFO - Epoch [12/100] (546) train_mae: 16.7617, val_mae: 20.9227 lr:0.010000 15.4s
2019-10-15 14:39:41,283 - INFO - Epoch [13/100] (588) train_mae: 16.1451, val_mae: 18.0042 lr:0.010000 15.4s
2019-10-15 14:39:56,955 - INFO - Epoch [14/100] (630) train_mae: 15.9375, val_mae: 16.4947 lr:0.010000 15.7s
2019-10-15 14:39:56,970 - INFO - Val loss decrease from 17.3515 to 16.4947, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-16.4947-630
2019-10-15 14:40:12,398 - INFO - Epoch [15/100] (672) train_mae: 15.7258, val_mae: 17.6510 lr:0.010000 15.4s
2019-10-15 14:40:28,046 - INFO - Epoch [16/100] (714) train_mae: 15.6145, val_mae: 16.7826 lr:0.010000 15.6s
2019-10-15 14:40:43,503 - INFO - Epoch [17/100] (756) train_mae: 14.9946, val_mae: 16.1093 lr:0.010000 15.5s
2019-10-15 14:40:43,518 - INFO - Val loss decrease from 16.4947 to 16.1093, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-16.1093-756
2019-10-15 14:40:59,203 - INFO - Epoch [18/100] (798) train_mae: 14.8889, val_mae: 16.3962 lr:0.010000 15.7s
2019-10-15 14:41:14,971 - INFO - Epoch [19/100] (840) train_mae: 14.3868, val_mae: 16.0949 lr:0.010000 15.8s
2019-10-15 14:41:17,176 - INFO - Horizon 04, MAE: 26.92, MAPE: 0.1346, RMSE: 40.34
2019-10-15 14:41:17,192 - INFO - Val loss decrease from 16.1093 to 16.0949, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-16.0949-840
2019-10-15 14:41:32,793 - INFO - Epoch [20/100] (882) train_mae: 13.4272, val_mae: 14.5623 lr:0.001000 15.6s
2019-10-15 14:41:32,808 - INFO - Val loss decrease from 16.0949 to 14.5623, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-14.5623-882
2019-10-15 14:41:48,406 - INFO - Epoch [21/100] (924) train_mae: 13.2130, val_mae: 14.1491 lr:0.001000 15.6s
2019-10-15 14:41:48,421 - INFO - Val loss decrease from 14.5623 to 14.1491, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-14.1491-924
2019-10-15 14:42:04,148 - INFO - Epoch [22/100] (966) train_mae: 13.0006, val_mae: 14.0739 lr:0.001000 15.7s
2019-10-15 14:42:04,163 - INFO - Val loss decrease from 14.1491 to 14.0739, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-14.0739-966
2019-10-15 14:42:19,893 - INFO - Epoch [23/100] (1008) train_mae: 12.8546, val_mae: 13.9377 lr:0.001000 15.7s
2019-10-15 14:42:19,908 - INFO - Val loss decrease from 14.0739 to 13.9377, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-13.9377-1008
2019-10-15 14:42:35,780 - INFO - Epoch [24/100] (1050) train_mae: 12.8600, val_mae: 13.6051 lr:0.001000 15.9s
2019-10-15 14:42:35,795 - INFO - Val loss decrease from 13.9377 to 13.6051, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-13.6051-1050
2019-10-15 14:42:51,622 - INFO - Epoch [25/100] (1092) train_mae: 12.8566, val_mae: 14.6873 lr:0.001000 15.8s
2019-10-15 14:43:07,502 - INFO - Epoch [26/100] (1134) train_mae: 12.9881, val_mae: 13.6207 lr:0.001000 15.9s
2019-10-15 14:43:23,292 - INFO - Epoch [27/100] (1176) train_mae: 12.7691, val_mae: 13.3099 lr:0.001000 15.8s
2019-10-15 14:43:23,307 - INFO - Val loss decrease from 13.6051 to 13.3099, saving to data/5083_P2_o12_sh/5083_P2_o12_sh4/dcrnn_DR_2_sh_4_64-64_lr_0.01_bs_64_20191015143556/models-13.3099-1176
2019-10-15 14:43:39,211 - INFO - Epoch [28/100] (1218) train_mae: 12.6400, val_mae: 14.0813 lr:0.001000 15.9s
2019-10-15 14:43:54,960 - INFO - Epoch [29/100] (1260) train_mae: 12.6116, val_mae: 13.6981 lr:0.001000 15.7s
2019-10-15 14:43:57,130 - INFO - Horizon 04, MAE: 25.42, MAPE: 0.1256, RMSE: 39.28
2019-10-15 14:44:13,027 - INFO - Epoch [30/100] (1302) train_mae: 12.1975, val_mae: 13.5882 lr:0.000100 15.9s
2019-10-15 14:44:28,833 - INFO - Epoch [31/100] (1344) train_mae: 12.1825, val_mae: 13.4538 lr:0.000100 15.8s
2019-10-15 14:44:45,093 - INFO - Epoch [32/100] (1386) train_mae: 12.2507, val_mae: 13.3965 lr:0.000100 16.3s
2019-10-15 14:45:01,057 - INFO - Epoch [33/100] (1428) train_mae: 12.2193, val_mae: 13.3754 lr:0.000100 16.0s
2019-10-15 14:45:16,953 - INFO - Epoch [34/100] (1470) train_mae: 12.1973, val_mae: 13.5466 lr:0.000100 15.9s
2019-10-15 14:45:32,879 - INFO - Epoch [35/100] (1512) train_mae: 12.2888, val_mae: 13.4918 lr:0.000100 15.9s
2019-10-15 14:45:48,695 - INFO - Epoch [36/100] (1554) train_mae: 12.3347, val_mae: 13.3846 lr:0.000100 15.8s
2019-10-15 14:46:04,501 - INFO - Epoch [37/100] (1596) train_mae: 12.2956, val_mae: 13.4413 lr:0.000100 15.8s
2019-10-15 14:46:20,344 - INFO - Epoch [38/100] (1638) train_mae: 12.4086, val_mae: 13.5830 lr:0.000100 15.8s
2019-10-15 14:46:36,240 - INFO - Epoch [39/100] (1680) train_mae: 12.2856, val_mae: 13.5536 lr:0.000100 15.9s
2019-10-15 14:46:38,475 - INFO - Horizon 04, MAE: 25.53, MAPE: 0.1266, RMSE: 39.45
2019-10-15 14:46:54,626 - INFO - Epoch [40/100] (1722) train_mae: 12.3063, val_mae: 13.5423 lr:0.000010 16.2s
2019-10-15 14:47:10,349 - INFO - Epoch [41/100] (1764) train_mae: 12.2214, val_mae: 13.5217 lr:0.000010 15.7s
2019-10-15 14:47:26,207 - INFO - Epoch [42/100] (1806) train_mae: 12.0956, val_mae: 13.4894 lr:0.000010 15.9s
2019-10-15 14:47:42,616 - INFO - Epoch [43/100] (1848) train_mae: 12.1548, val_mae: 13.5010 lr:0.000010 16.4s
2019-10-15 14:47:58,538 - INFO - Epoch [44/100] (1890) train_mae: 12.2654, val_mae: 13.4994 lr:0.000010 15.9s
2019-10-15 14:48:14,581 - INFO - Epoch [45/100] (1932) train_mae: 12.2170, val_mae: 13.4612 lr:0.000010 16.0s
2019-10-15 14:48:30,765 - INFO - Epoch [46/100] (1974) train_mae: 12.1345, val_mae: 13.4715 lr:0.000010 16.2s
2019-10-15 14:48:46,797 - INFO - Epoch [47/100] (2016) train_mae: 12.2920, val_mae: 13.4557 lr:0.000010 16.0s
2019-10-15 14:49:03,038 - INFO - Epoch [48/100] (2058) train_mae: 12.1021, val_mae: 13.4223 lr:0.000010 16.2s
2019-10-15 14:49:19,211 - INFO - Epoch [49/100] (2100) train_mae: 12.2152, val_mae: 13.4118 lr:0.000010 16.2s
2019-10-15 14:49:21,847 - INFO - Horizon 04, MAE: 25.37, MAPE: 0.1257, RMSE: 39.25
2019-10-15 14:49:38,359 - INFO - Epoch [50/100] (2142) train_mae: 12.0037, val_mae: 13.4138 lr:0.000002 16.5s
2019-10-15 14:49:54,909 - INFO - Epoch [51/100] (2184) train_mae: 12.1168, val_mae: 13.4146 lr:0.000002 16.5s
2019-10-15 14:50:11,212 - INFO - Epoch [52/100] (2226) train_mae: 12.3632, val_mae: 13.4147 lr:0.000002 16.3s
2019-10-15 14:50:27,734 - INFO - Epoch [53/100] (2268) train_mae: 12.0772, val_mae: 13.4158 lr:0.000002 16.5s
2019-10-15 14:50:43,933 - INFO - Epoch [54/100] (2310) train_mae: 12.0657, val_mae: 13.4299 lr:0.000002 16.2s
2019-10-15 14:50:59,998 - INFO - Epoch [55/100] (2352) train_mae: 11.9161, val_mae: 13.4331 lr:0.000002 16.1s
2019-10-15 14:51:16,118 - INFO - Epoch [56/100] (2394) train_mae: 12.0335, val_mae: 13.4361 lr:0.000002 16.1s
2019-10-15 14:51:32,338 - INFO - Epoch [57/100] (2436) train_mae: 12.0504, val_mae: 13.4330 lr:0.000002 16.2s
2019-10-15 14:51:48,430 - INFO - Epoch [58/100] (2478) train_mae: 12.1620, val_mae: 13.4274 lr:0.000002 16.1s
2019-10-15 14:52:04,589 - INFO - Epoch [59/100] (2520) train_mae: 12.1026, val_mae: 13.4206 lr:0.000002 16.2s
2019-10-15 14:52:06,881 - INFO - Horizon 04, MAE: 25.39, MAPE: 0.1260, RMSE: 39.28
2019-10-15 14:52:22,933 - INFO - Epoch [60/100] (2562) train_mae: 12.2075, val_mae: 13.4321 lr:0.000002 16.1s
2019-10-15 14:52:39,313 - INFO - Epoch [61/100] (2604) train_mae: 11.8614, val_mae: 13.4285 lr:0.000002 16.4s
2019-10-15 14:52:55,285 - INFO - Epoch [62/100] (2646) train_mae: 12.1077, val_mae: 13.4282 lr:0.000002 16.0s
2019-10-15 14:53:11,339 - INFO - Epoch [63/100] (2688) train_mae: 12.1983, val_mae: 13.4128 lr:0.000002 16.1s
2019-10-15 14:53:27,324 - INFO - Epoch [64/100] (2730) train_mae: 12.1085, val_mae: 13.4108 lr:0.000002 16.0s
2019-10-15 14:53:43,624 - INFO - Epoch [65/100] (2772) train_mae: 12.1231, val_mae: 13.4165 lr:0.000002 16.3s
2019-10-15 14:53:59,780 - INFO - Epoch [66/100] (2814) train_mae: 12.0959, val_mae: 13.4277 lr:0.000002 16.2s
2019-10-15 14:54:15,920 - INFO - Epoch [67/100] (2856) train_mae: 12.0659, val_mae: 13.4321 lr:0.000002 16.1s
2019-10-15 14:54:32,055 - INFO - Epoch [68/100] (2898) train_mae: 12.0426, val_mae: 13.4360 lr:0.000002 16.1s
2019-10-15 14:54:48,269 - INFO - Epoch [69/100] (2940) train_mae: 12.1441, val_mae: 13.4303 lr:0.000002 16.2s
2019-10-15 14:54:50,761 - INFO - Horizon 04, MAE: 25.38, MAPE: 0.1262, RMSE: 39.27
2019-10-15 14:55:06,994 - INFO - Epoch [70/100] (2982) train_mae: 12.0558, val_mae: 13.4264 lr:0.000002 16.2s
2019-10-15 14:55:23,174 - INFO - Epoch [71/100] (3024) train_mae: 12.1628, val_mae: 13.4187 lr:0.000002 16.2s
2019-10-15 14:55:39,352 - INFO - Epoch [72/100] (3066) train_mae: 12.1813, val_mae: 13.4198 lr:0.000002 16.2s
2019-10-15 14:55:55,405 - INFO - Epoch [73/100] (3108) train_mae: 12.2215, val_mae: 13.4226 lr:0.000002 16.1s
2019-10-15 14:56:11,565 - INFO - Epoch [74/100] (3150) train_mae: 12.0780, val_mae: 13.4221 lr:0.000002 16.2s
2019-10-15 14:56:27,712 - INFO - Epoch [75/100] (3192) train_mae: 12.0352, val_mae: 13.4235 lr:0.000002 16.1s
2019-10-15 14:56:43,928 - INFO - Epoch [76/100] (3234) train_mae: 12.1876, val_mae: 13.4344 lr:0.000002 16.2s
2019-10-15 14:57:00,087 - INFO - Epoch [77/100] (3276) train_mae: 11.9877, val_mae: 13.4306 lr:0.000002 16.2s
2019-10-15 14:57:16,226 - INFO - Epoch [78/100] (3318) train_mae: 12.1492, val_mae: 13.4335 lr:0.000002 16.1s
2019-10-15 14:57:16,227 - WARNING - Early stopping at epoch: 78
2019-10-15 14:57:18,567 - INFO - Horizon 04, MAE: 25.38, MAPE: 0.1260, RMSE: 39.28
Predictions saved as data/5083_P2_o12_sh/5083_P2_o12_sh4/prediction3.npz.
Trained DCRNN model
train mae: 12.1492
val mae: 13.4335
test mse: 1640.2983380800574
test rmse: 40.50059676202386
test mae: 25.661187439356098
test mape: 31.240153484155442
